{% extends 'base.html.twig' %}

{% block title %}
	{{ challenge.title }}
	- CreativeHub
{% endblock %}

{% block body %}
	<div class="min-h-screen bg-main py-8">
		<div class="container-medium">
			{% include "partials/_messages.html.twig" %}

			{# Bouton retour #}
			<a class="link-nav inline-flex items-center mb-6" href="{{ path('app_challenge_index') }}">
				<svg class="icon-sm mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" stroke-width="2">
					<path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path>
				</svg>
				<span>Retour aux défis</span>
			</a>

			{# carte principale du challenge #}
			<div
				class="card overflow-hidden mb-8">
				{# image #}
				{% if challenge.medias|length > 0 %}
					<img class="w-full h-96 object-cover" src="{{ challenge.medias.first.path }}" alt="{{ challenge.title }}">
				{% else %}
					<div class="w-full h-96 gradient-placeholder flex items-center justify-center">
						<svg class="w-24 h-24 text-primary" fill="none" stroke="currentColor" viewbox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
						</svg>
					</div>
				{% endif %}

				<div
					class="p-8">
					{# en tête #}
					<div class="flex items-center justify-between">
						<span class="badge-category">
							{{ challenge.category.label }}
						</span>
						{% if app.user and (is_granted('ROLE_ADMIN') or challenge.user == app.user) %}
							<div class="flex gap-2">
								<a class="btn-secondary flex items-center space-x-2" href="{{ path('app_challenge_edit', {id: challenge.id}) }}">
									<svg class="icon-with-text" fill="none" stroke="currentColor" viewbox="0 0 24 24" stroke-width="2">
										<path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
									</svg>
									<span>Modifier</span>
								</a>
								<form action="{{ path('app_challenge_delete', {id:challenge.id}) }}" method="post" class="inline" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer ce défi ?')">
									<input type="hidden" name="_token" value="{{ csrf_token('delete_challenge_' ~ challenge.id) }}">
									<button type="submit" class="btn-danger flex items-center space-x-2">
										<svg class="icon-with-text" fill="none" stroke="currentColor" viewbox="0 0 24 24" stroke-width="2">
											<path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
										</svg>
										<span>Supprimer</span>
									</button>
								</form>
							</div>
						{% endif %}
					</div>
					<h1 class="text-4xl text-gray-900 mb-4">{{ challenge.title }}</h1>
					<div class="flex items-center text-gray-600 mb-4">
						<div class="avatar-md mr-3">
							<span class="avatar-initial">
								{{ challenge.user.pseudo|slice(0,1)|upper }}
							</span>
						</div>
						<div>
							<p class="font-medium text-gray-900">{{ challenge.user.pseudo }}</p>
							<p class="text-sm">{{ challenge.createdAt|date('d/m/Y à H:i') }}</p>
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>


{% endblock %}
